<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500">
  <defs>
    <linearGradient id="ppgGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#e67e22;stop-opacity:0.8"/>
      <stop offset="100%" style="stop-color:#e67e22;stop-opacity:0.1"/>
    </linearGradient>
  </defs>
  
  <!-- Background -->
  <rect width="800" height="500" fill="#fafafa"/>
  
  <!-- Title -->
  <text x="400" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#2c3e50">
    Análisis Espectral FFT - Señal PPG (Allen Gaussian Model)
  </text>
  <text x="400" y="55" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#7f8c8d">
    Frecuencia de muestreo: 100 Hz | Ventana: Hanning | N = 2048
  </text>
  
  <!-- Grid area -->
  <rect x="100" y="80" width="600" height="320" fill="white" stroke="#bdc3c7" stroke-width="1"/>
  
  <!-- Grid lines -->
  <g stroke="#ecf0f1" stroke-width="1">
    <line x1="100" y1="160" x2="700" y2="160"/>
    <line x1="100" y1="240" x2="700" y2="240"/>
    <line x1="100" y1="320" x2="700" y2="320"/>
    <line x1="220" y1="80" x2="220" y2="400"/>
    <line x1="340" y1="80" x2="340" y2="400"/>
    <line x1="460" y1="80" x2="460" y2="400"/>
    <line x1="580" y1="80" x2="580" y2="400"/>
  </g>
  
  <!-- PPG Spectrum - very narrow, low frequency -->
  <path d="M100,400
           L100,180 L110,120 L115,100 L120,90 L125,86 L130,90 L135,100 L140,120
           L150,170 L160,230 L170,290 L180,335 L190,360 L200,375 L220,388 L250,394
           L300,397 L400,399 L500,400 L600,400 L700,400 Z"
        fill="url(#ppgGradient)"/>
  
  <!-- Spectrum line -->
  <path d="M100,180 L110,120 L115,100 L120,90 L125,86 L130,90 L135,100 L140,120
           L150,170 L160,230 L170,290 L180,335 L190,360 L200,375 L220,388 L250,394
           L300,397 L400,399 L500,400 L600,400 L700,400"
        fill="none" stroke="#d35400" stroke-width="2.5"/>
  
  <!-- Peak marker at ~1.14 Hz -->
  <circle cx="125" cy="86" r="6" fill="#e67e22" stroke="white" stroke-width="2"/>
  <line x1="125" y1="86" x2="125" y2="400" stroke="#e67e22" stroke-width="1" stroke-dasharray="5,5"/>
  
  <!-- F99 marker at 4.9 Hz -->
  <line x1="195" y1="80" x2="195" y2="400" stroke="#27ae60" stroke-width="2" stroke-dasharray="8,4"/>
  <text x="200" y="95" font-family="Arial, sans-serif" font-size="11" fill="#27ae60" font-weight="bold">F99% = 4.9 Hz</text>
  
  <!-- Nyquist limit annotation -->
  <line x1="700" y1="80" x2="700" y2="400" stroke="#e74c3c" stroke-width="2"/>
  <text x="680" y="95" font-family="Arial, sans-serif" font-size="10" fill="#e74c3c" text-anchor="end">Nyquist 50 Hz</text>
  
  <!-- Bandwidth annotation -->
  <line x1="100" y1="180" x2="195" y2="180" stroke="#3498db" stroke-width="1.5"/>
  <line x1="100" y1="175" x2="100" y2="185" stroke="#3498db" stroke-width="1.5"/>
  <line x1="195" y1="175" x2="195" y2="185" stroke="#3498db" stroke-width="1.5"/>
  <text x="147" y="170" font-family="Arial, sans-serif" font-size="10" fill="#3498db" text-anchor="middle">BW = 4.9 Hz</text>
  
  <!-- Clinical band 0.5-5 Hz -->
  <rect x="108" y="85" width="90" height="10" fill="#2ecc71" opacity="0.3"/>
  <text x="153" y="78" font-family="Arial, sans-serif" font-size="9" fill="#27ae60" text-anchor="middle">Banda clínica 0.5-5 Hz</text>
  
  <!-- Axis labels -->
  <text x="400" y="435" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#2c3e50">Frecuencia (Hz)</text>
  <text x="40" y="240" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#2c3e50" transform="rotate(-90, 40, 240)">Magnitud (dB)</text>
  
  <!-- X axis ticks - PPG has much lower frequencies -->
  <text x="100" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#7f8c8d">0</text>
  <text x="125" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#e67e22" font-weight="bold">1.14</text>
  <text x="220" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#7f8c8d">5</text>
  <text x="340" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#7f8c8d">10</text>
  <text x="460" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#7f8c8d">20</text>
  <text x="580" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#7f8c8d">35</text>
  <text x="700" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#7f8c8d">50</text>
  
  <!-- Y axis ticks -->
  <text x="90" y="405" text-anchor="end" font-family="Arial, sans-serif" font-size="11" fill="#7f8c8d">-60</text>
  <text x="90" y="325" text-anchor="end" font-family="Arial, sans-serif" font-size="11" fill="#7f8c8d">-40</text>
  <text x="90" y="245" text-anchor="end" font-family="Arial, sans-serif" font-size="11" fill="#7f8c8d">-20</text>
  <text x="90" y="165" text-anchor="end" font-family="Arial, sans-serif" font-size="11" fill="#7f8c8d">-10</text>
  <text x="90" y="85" text-anchor="end" font-family="Arial, sans-serif" font-size="11" fill="#7f8c8d">0</text>
  
  <!-- Legend box -->
  <rect x="520" y="100" width="170" height="150" fill="white" stroke="#bdc3c7" rx="5"/>
  <text x="530" y="120" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">Resultados FFT</text>
  
  <circle cx="540" cy="140" r="5" fill="#e67e22"/>
  <text x="550" y="144" font-family="Arial, sans-serif" font-size="11" fill="#34495e">Pico fundamental: 1.14 Hz</text>
  
  <line x1="530" y1="160" x2="550" y2="160" stroke="#27ae60" stroke-width="2" stroke-dasharray="5,3"/>
  <text x="555" y="164" font-family="Arial, sans-serif" font-size="11" fill="#34495e">F99% energía: 4.9 Hz</text>
  
  <line x1="530" y1="180" x2="550" y2="180" stroke="#3498db" stroke-width="2"/>
  <text x="555" y="184" font-family="Arial, sans-serif" font-size="11" fill="#34495e">BW señal: 4.9 Hz</text>
  
  <rect x="530" y="195" width="15" height="10" fill="#2ecc71" opacity="0.4"/>
  <text x="550" y="204" font-family="Arial, sans-serif" font-size="11" fill="#34495e">Banda clínica</text>
  
  <text x="530" y="222" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">Fs modelo: 100 Hz ✓</text>
  <text x="530" y="238" font-family="Arial, sans-serif" font-size="9" fill="#95a5a6" font-style="italic">Margen Nyquist: 10× ✓</text>
  
  <!-- Footer note -->
  <text x="400" y="475" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#95a5a6">
    BioSimulator Pro - Validación espectral modelo PPG Allen | Nyquist: 50 Hz &gt; 4.9 Hz ✓ (Fs elevada para display fluido)
  </text>
</svg>