<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1100 700" width="1100" height="700">
  <defs>
    <marker id="arrow" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#555"/>
    </marker>
    <marker id="arrowGreen" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#27ae60"/>
    </marker>
    <marker id="arrowOrange" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#e67e22"/>
    </marker>
  </defs>
  
  <!-- Fondo -->
  <rect width="1100" height="700" fill="#ffffff"/>
  
  <!-- T√≠tulo -->
  <text x="550" y="28" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#333" text-anchor="middle" font-style="italic">
    Arquitectura de la Aplicaci√≥n Web - Sistema de Visualizaci√≥n Remota
  </text>
  
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- CAPA SERVIDOR (ESP32) -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  
  <rect x="40" y="50" width="350" height="340" rx="10" fill="#f8f9fa" stroke="#3498db" stroke-width="2"/>
  <rect x="40" y="50" width="350" height="30" rx="10" fill="#3498db"/>
  <text x="215" y="70" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">ESP32 - Servidor Embebido</text>
  
  <!-- WiFi AP -->
  <rect x="60" y="95" width="150" height="70" rx="5" fill="#e3f2fd" stroke="#1976d2" stroke-width="1.2"/>
  <text x="135" y="115" font-family="Arial, sans-serif" font-size="10" fill="#1976d2" text-anchor="middle" font-weight="bold">WiFi Access Point</text>
  <text x="135" y="132" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">SSID: BioSimulator_Pro</text>
  <text x="135" y="147" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">IP: 192.168.4.1</text>
  <text x="135" y="160" font-family="Arial, sans-serif" font-size="8" fill="#666" text-anchor="middle">802.11 b/g/n</text>
  
  <!-- HTTP Server -->
  <rect x="220" y="95" width="150" height="70" rx="5" fill="#fff3e0" stroke="#e65100" stroke-width="1.2"/>
  <text x="295" y="115" font-family="Arial, sans-serif" font-size="10" fill="#e65100" text-anchor="middle" font-weight="bold">Servidor HTTP</text>
  <text x="295" y="132" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">Puerto: 80</text>
  <text x="295" y="147" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">Sirve archivos SPIFFS</text>
  <text x="295" y="160" font-family="Arial, sans-serif" font-size="8" fill="#666" text-anchor="middle">index.html, app.js, styles.css</text>
  
  <!-- WebSocket Server -->
  <rect x="60" y="180" width="310" height="90" rx="5" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1.5"/>
  <text x="215" y="200" font-family="Arial, sans-serif" font-size="11" fill="#2e7d32" text-anchor="middle" font-weight="bold">Servidor WebSocket (AsyncWebSocket)</text>
  <text x="215" y="220" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle">Puerto: 81 | Endpoint: ws://192.168.4.1:81/ws</text>
  <text x="215" y="238" font-family="Arial, sans-serif" font-size="9" fill="#666" text-anchor="middle">Full-duplex persistente | Max clientes: 4</text>
  <text x="215" y="256" font-family="Arial, sans-serif" font-size="9" fill="#666" text-anchor="middle">Latencia: &lt;50 ms | Overhead: 2-6 bytes/msg</text>
  
  <!-- SignalEngine conexi√≥n -->
  <rect x="60" y="285" width="150" height="50" rx="5" fill="#ffebee" stroke="#c62828" stroke-width="1"/>
  <text x="135" y="305" font-family="Arial, sans-serif" font-size="9" fill="#c62828" text-anchor="middle" font-weight="bold">SignalEngine</text>
  <text x="135" y="322" font-family="Arial, sans-serif" font-size="8" fill="#666" text-anchor="middle">getDisplaySample()</text>
  
  <line x1="135" y1="335" x2="135" y2="355" stroke="#666" stroke-width="1" marker-end="url(#arrow)"/>
  
  <!-- Serializaci√≥n JSON -->
  <rect x="60" y="360" width="150" height="50" rx="5" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="1"/>
  <text x="135" y="380" font-family="Arial, sans-serif" font-size="9" fill="#7b1fa2" text-anchor="middle" font-weight="bold">Serializaci√≥n</text>
  <text x="135" y="395" font-family="Courier New" font-size="8" fill="#666" text-anchor="middle">JSON minificado</text>
  
  <!-- M√©tricas -->
  <rect x="220" y="285" width="150" height="125" rx="5" fill="#fff" stroke="#555" stroke-width="1"/>
  <text x="295" y="303" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle" font-weight="bold">Tasas de Transmisi√≥n</text>
  <line x1="225" y1="310" x2="365" y2="310" stroke="#ddd" stroke-width="1"/>
  <text x="235" y="328" font-family="Arial, sans-serif" font-size="8" fill="#666">Se√±al:</text>
  <text x="295" y="328" font-family="Arial, sans-serif" font-size="8" fill="#333">100 msg/s (10 ms)</text>
  <text x="235" y="345" font-family="Arial, sans-serif" font-size="8" fill="#666">M√©tricas:</text>
  <text x="295" y="345" font-family="Arial, sans-serif" font-size="8" fill="#333">4 msg/s (250 ms)</text>
  <text x="235" y="362" font-family="Arial, sans-serif" font-size="8" fill="#666">Estado:</text>
  <text x="295" y="362" font-family="Arial, sans-serif" font-size="8" fill="#333">On-demand</text>
  <line x1="225" y1="375" x2="365" y2="375" stroke="#ddd" stroke-width="1"/>
  <text x="295" y="393" font-family="Arial, sans-serif" font-size="8" fill="#666" text-anchor="middle">~3.5 KB/s = 28 Kbps</text>
  <text x="295" y="406" font-family="Arial, sans-serif" font-size="8" fill="#27ae60" text-anchor="middle">(0.25% de 11 Mbps WiFi)</text>
  
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- CANAL DE COMUNICACI√ìN -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  
  <rect x="420" y="120" width="130" height="250" rx="8" fill="#eef7ff" stroke="#3498db" stroke-width="2" stroke-dasharray="5,3"/>
  <text x="485" y="145" font-family="Arial, sans-serif" font-size="10" fill="#2980b9" text-anchor="middle" font-weight="bold">Canal</text>
  <text x="485" y="160" font-family="Arial, sans-serif" font-size="10" fill="#2980b9" text-anchor="middle" font-weight="bold">WebSocket</text>
  
  <!-- Flecha datos -->
  <line x1="390" y1="200" x2="420" y2="200" stroke="#27ae60" stroke-width="3" marker-end="url(#arrowGreen)"/>
  <text x="405" y="193" font-family="Arial, sans-serif" font-size="7" fill="#27ae60">DATA</text>
  
  <line x1="550" y1="200" x2="580" y2="200" stroke="#27ae60" stroke-width="3" marker-end="url(#arrowGreen)"/>
  
  <!-- Flecha comandos -->
  <line x1="420" y1="300" x2="390" y2="300" stroke="#e67e22" stroke-width="2" marker-end="url(#arrowOrange)"/>
  <text x="405" y="293" font-family="Arial, sans-serif" font-size="7" fill="#e67e22">CMD</text>
  
  <line x1="580" y1="300" x2="550" y2="300" stroke="#e67e22" stroke-width="2" marker-end="url(#arrowOrange)"/>
  
  <!-- Protocolo en canal -->
  <rect x="435" y="185" width="100" height="45" rx="3" fill="#27ae60"/>
  <text x="485" y="203" font-family="Arial, sans-serif" font-size="8" fill="white" text-anchor="middle" font-weight="bold">Stream ‚Üí</text>
  <text x="485" y="218" font-family="Courier New" font-size="7" fill="#ecf0f1" text-anchor="middle">{"t":"s","v":128}</text>
  
  <rect x="435" y="250" width="100" height="45" rx="3" fill="#e67e22"/>
  <text x="485" y="268" font-family="Arial, sans-serif" font-size="8" fill="white" text-anchor="middle" font-weight="bold">‚Üê Control</text>
  <text x="485" y="283" font-family="Courier New" font-size="7" fill="#ecf0f1" text-anchor="middle">{"cmd":"start"}</text>
  
  <text x="485" y="330" font-family="Arial, sans-serif" font-size="8" fill="#7f8c8d" text-anchor="middle">Bidireccional</text>
  <text x="485" y="345" font-family="Arial, sans-serif" font-size="8" fill="#7f8c8d" text-anchor="middle">persistente</text>
  
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- CAPA CLIENTE (NAVEGADOR) -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  
  <rect x="580" y="50" width="480" height="340" rx="10" fill="#f8f9fa" stroke="#e67e22" stroke-width="2"/>
  <rect x="580" y="50" width="480" height="30" rx="10" fill="#e67e22"/>
  <text x="820" y="70" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">Navegador Web - Cliente JavaScript</text>
  
  <!-- Estructura de archivos -->
  <rect x="600" y="95" width="200" height="120" rx="5" fill="#fff" stroke="#555" stroke-width="1"/>
  <text x="700" y="113" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle" font-weight="bold">Archivos SPIFFS</text>
  <line x1="605" y1="120" x2="795" y2="120" stroke="#ddd" stroke-width="1"/>
  
  <text x="615" y="140" font-family="Courier New" font-size="9" fill="#e67e22">üìÑ index.html</text>
  <text x="710" y="140" font-family="Arial, sans-serif" font-size="8" fill="#666">Estructura UI</text>
  
  <text x="615" y="160" font-family="Courier New" font-size="9" fill="#3498db">üìÑ styles.css</text>
  <text x="710" y="160" font-family="Arial, sans-serif" font-size="8" fill="#666">Estilos visuales</text>
  
  <text x="615" y="180" font-family="Courier New" font-size="9" fill="#f39c12">üìÑ app.js</text>
  <text x="710" y="180" font-family="Arial, sans-serif" font-size="8" fill="#666">L√≥gica WebSocket</text>
  
  <text x="615" y="200" font-family="Arial, sans-serif" font-size="8" fill="#666">Total: ~15 KB comprimido</text>
  
  <!-- WebSocket API -->
  <rect x="815" y="95" width="230" height="60" rx="5" fill="#fff3e0" stroke="#e65100" stroke-width="1.2"/>
  <text x="930" y="115" font-family="Arial, sans-serif" font-size="10" fill="#e65100" text-anchor="middle" font-weight="bold">WebSocket API (Browser)</text>
  <text x="930" y="132" font-family="Courier New" font-size="8" fill="#333" text-anchor="middle">new WebSocket("ws://192.168.4.1:81/ws")</text>
  <text x="930" y="147" font-family="Arial, sans-serif" font-size="8" fill="#666" text-anchor="middle">onopen | onmessage | onclose | onerror</text>
  
  <!-- Pipeline de procesamiento -->
  <rect x="600" y="225" width="440" height="80" rx="5" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1.2"/>
  <text x="820" y="245" font-family="Arial, sans-serif" font-size="10" fill="#2e7d32" text-anchor="middle" font-weight="bold">Pipeline de Procesamiento Cliente</text>
  
  <!-- Pasos del pipeline -->
  <rect x="615" y="255" width="90" height="40" rx="3" fill="#fff" stroke="#666" stroke-width="1"/>
  <text x="660" y="272" font-family="Arial, sans-serif" font-size="8" fill="#333" text-anchor="middle" font-weight="bold">1. Recepci√≥n</text>
  <text x="660" y="285" font-family="Arial, sans-serif" font-size="7" fill="#666" text-anchor="middle">onmessage()</text>
  
  <line x1="705" y1="275" x2="725" y2="275" stroke="#555" stroke-width="1" marker-end="url(#arrow)"/>
  
  <rect x="730" y="255" width="90" height="40" rx="3" fill="#fff" stroke="#666" stroke-width="1"/>
  <text x="775" y="272" font-family="Arial, sans-serif" font-size="8" fill="#333" text-anchor="middle" font-weight="bold">2. Parse</text>
  <text x="775" y="285" font-family="Arial, sans-serif" font-size="7" fill="#666" text-anchor="middle">JSON.parse()</text>
  
  <line x1="820" y1="275" x2="840" y2="275" stroke="#555" stroke-width="1" marker-end="url(#arrow)"/>
  
  <rect x="845" y="255" width="90" height="40" rx="3" fill="#fff" stroke="#666" stroke-width="1"/>
  <text x="890" y="272" font-family="Arial, sans-serif" font-size="8" fill="#333" text-anchor="middle" font-weight="bold">3. Buffer</text>
  <text x="890" y="285" font-family="Arial, sans-serif" font-size="7" fill="#666" text-anchor="middle">700 puntos</text>
  
  <line x1="935" y1="275" x2="955" y2="275" stroke="#555" stroke-width="1" marker-end="url(#arrow)"/>
  
  <rect x="960" y="255" width="70" height="40" rx="3" fill="#fff" stroke="#666" stroke-width="1"/>
  <text x="995" y="272" font-family="Arial, sans-serif" font-size="8" fill="#333" text-anchor="middle" font-weight="bold">4. Render</text>
  <text x="995" y="285" font-family="Arial, sans-serif" font-size="7" fill="#666" text-anchor="middle">Canvas</text>
  
  <!-- Canvas Rendering -->
  <rect x="600" y="315" width="220" height="65" rx="5" fill="#1a1a2e" stroke="#3498db" stroke-width="1.5"/>
  <text x="710" y="335" font-family="Arial, sans-serif" font-size="9" fill="#3498db" text-anchor="middle" font-weight="bold">Canvas HTML5 (700√ó300 px)</text>
  
  <!-- Se√±al simulada en canvas -->
  <polyline points="610,355 630,355 640,350 650,370 660,340 670,360 680,355 700,355 720,355 730,350 740,370 750,340 760,360 770,355 790,355 810,355" 
        fill="none" stroke="#2ecc71" stroke-width="1.5"/>
  
  <text x="710" y="375" font-family="Arial, sans-serif" font-size="7" fill="#7f8c8d" text-anchor="middle">requestAnimationFrame() @ 60 fps</text>
  
  <!-- UI Controls -->
  <rect x="835" y="315" width="205" height="65" rx="5" fill="#fff" stroke="#555" stroke-width="1"/>
  <text x="937" y="333" font-family="Arial, sans-serif" font-size="9" fill="#333" text-anchor="middle" font-weight="bold">Controles UI</text>
  <text x="850" y="350" font-family="Arial, sans-serif" font-size="8" fill="#666">‚ñ∂ Start/Stop</text>
  <text x="930" y="350" font-family="Arial, sans-serif" font-size="8" fill="#666">üìä Tipo se√±al</text>
  <text x="850" y="365" font-family="Arial, sans-serif" font-size="8" fill="#666">‚öô Par√°metros</text>
  <text x="930" y="365" font-family="Arial, sans-serif" font-size="8" fill="#666">üìà M√©tricas</text>
  <text x="937" y="378" font-family="Arial, sans-serif" font-size="7" fill="#666" text-anchor="middle">Env√≠an comandos JSON al servidor</text>
  
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- PROTOCOLO DE MENSAJES -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  
  <rect x="40" y="420" width="1020" height="130" rx="8" fill="#fafafa" stroke="#bdc3c7" stroke-width="1"/>
  <text x="550" y="445" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333" text-anchor="middle">Protocolo de Mensajes WebSocket</text>
  
  <!-- Mensaje de se√±al -->
  <rect x="60" y="460" width="300" height="70" rx="5" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1"/>
  <text x="210" y="480" font-family="Arial, sans-serif" font-size="10" fill="#2e7d32" text-anchor="middle" font-weight="bold">Mensaje de Se√±al (cada 10 ms)</text>
  <text x="210" y="500" font-family="Courier New" font-size="10" fill="#333" text-anchor="middle">{"t":"s","v":128,"ts":12345678}</text>
  <text x="210" y="518" font-family="Arial, sans-serif" font-size="8" fill="#666" text-anchor="middle">t: tipo | v: valor DAC 0-255 | ts: timestamp ¬µs</text>
  
  <!-- Mensaje de m√©tricas -->
  <rect x="390" y="460" width="300" height="70" rx="5" fill="#e3f2fd" stroke="#1976d2" stroke-width="1"/>
  <text x="540" y="480" font-family="Arial, sans-serif" font-size="10" fill="#1976d2" text-anchor="middle" font-weight="bold">Mensaje de M√©tricas (cada 250 ms)</text>
  <text x="540" y="500" font-family="Courier New" font-size="9" fill="#333" text-anchor="middle">{"t":"m","hr":72,"spo2":98,"rms":0.45}</text>
  <text x="540" y="518" font-family="Arial, sans-serif" font-size="8" fill="#666" text-anchor="middle">hr: heart rate | spo2: saturaci√≥n | rms: amplitud</text>
  
  <!-- Mensaje de comando -->
  <rect x="720" y="460" width="320" height="70" rx="5" fill="#fff3e0" stroke="#e65100" stroke-width="1"/>
  <text x="880" y="480" font-family="Arial, sans-serif" font-size="10" fill="#e65100" text-anchor="middle" font-weight="bold">Mensaje de Comando (cliente‚Üíservidor)</text>
  <text x="880" y="500" font-family="Courier New" font-size="9" fill="#333" text-anchor="middle">{"cmd":"start","signal":"ECG","cond":0}</text>
  <text x="880" y="518" font-family="Arial, sans-serif" font-size="8" fill="#666" text-anchor="middle">cmd: acci√≥n | signal: tipo | cond: condici√≥n cl√≠nica</text>
  
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- DIAGRAMA DE SECUENCIA -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  
  <rect x="40" y="565" width="1020" height="120" rx="8" fill="#fafafa" stroke="#bdc3c7" stroke-width="1"/>
  <text x="550" y="585" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#333" text-anchor="middle">Secuencia de Conexi√≥n y Streaming</text>
  
  <!-- L√≠neas de vida -->
  <text x="150" y="605" font-family="Arial, sans-serif" font-size="9" fill="#666" text-anchor="middle">Cliente (Browser)</text>
  <line x1="150" y1="610" x2="150" y2="675" stroke="#666" stroke-width="1.5"/>
  
  <text x="550" y="605" font-family="Arial, sans-serif" font-size="9" fill="#666" text-anchor="middle">ESP32 HTTP</text>
  <line x1="550" y1="610" x2="550" y2="675" stroke="#666" stroke-width="1.5"/>
  
  <text x="900" y="605" font-family="Arial, sans-serif" font-size="9" fill="#666" text-anchor="middle">ESP32 WebSocket</text>
  <line x1="900" y1="610" x2="900" y2="675" stroke="#666" stroke-width="1.5"/>
  
  <!-- Mensajes -->
  <line x1="150" y1="620" x2="550" y2="620" stroke="#e67e22" stroke-width="1" marker-end="url(#arrow)"/>
  <text x="350" y="617" font-family="Arial, sans-serif" font-size="8" fill="#e67e22" text-anchor="middle">1. GET /index.html</text>
  
  <line x1="550" y1="632" x2="150" y2="632" stroke="#2e7d32" stroke-width="1" marker-end="url(#arrow)"/>
  <text x="350" y="629" font-family="Arial, sans-serif" font-size="8" fill="#2e7d32" text-anchor="middle">2. 200 OK + HTML/JS/CSS</text>
  
  <line x1="150" y1="645" x2="900" y2="645" stroke="#3498db" stroke-width="1" marker-end="url(#arrow)"/>
  <text x="525" y="642" font-family="Arial, sans-serif" font-size="8" fill="#3498db" text-anchor="middle">3. WebSocket Upgrade: ws://192.168.4.1:81/ws</text>
  
  <line x1="900" y1="657" x2="150" y2="657" stroke="#9b59b6" stroke-width="1" marker-end="url(#arrow)"/>
  <text x="525" y="654" font-family="Arial, sans-serif" font-size="8" fill="#9b59b6" text-anchor="middle">4. 101 Switching Protocols ‚Üí Conexi√≥n persistente</text>
  
  <line x1="900" y1="670" x2="150" y2="670" stroke="#27ae60" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="525" y="667" font-family="Arial, sans-serif" font-size="8" fill="#27ae60" text-anchor="middle" font-weight="bold">5. Stream continuo: {"t":"s","v":...} @ 100 Hz</text>
  
</svg>
