<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 950 600">
  <defs>
    <marker id="arrowDec" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2c3e50"/>
    </marker>
    <linearGradient id="gradInput" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3498db;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#2980b9;stop-opacity:1"/>
    </linearGradient>
    <linearGradient id="gradDecim" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#9b59b6;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#8e44ad;stop-opacity:1"/>
    </linearGradient>
    <linearGradient id="gradOutput" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#27ae60;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#1e8449;stop-opacity:1"/>
    </linearGradient>
  </defs>
  
  <!-- Título -->
  <text x="475" y="30" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    Estrategia de Decimación para Visualización
  </text>
  <text x="475" y="50" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#7f8c8d">
    Adaptación de frecuencia de muestreo a capacidad del canal de comunicación
  </text>
  
  <!-- Bloque del problema -->
  <rect x="50" y="70" width="400" height="100" rx="8" fill="#fdedec" stroke="#e74c3c" stroke-width="2"/>
  <text x="250" y="95" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#c0392b">Problema de Diseño</text>
  <text x="70" y="118" font-family="Arial, sans-serif" font-size="10" fill="#2c3e50">• Modelos generan a alta frecuencia (300-1000 Hz)</text>
  <text x="70" y="135" font-family="Arial, sans-serif" font-size="10" fill="#2c3e50">• Waveform Nextion actualiza a 100 Hz máximo</text>
  <text x="70" y="152" font-family="Arial, sans-serif" font-size="10" fill="#2c3e50">• UART tiene ancho de banda limitado (115200 bps)</text>
  
  <!-- Bloque de solución -->
  <rect x="500" y="70" width="400" height="100" rx="8" fill="#e8f8f5" stroke="#27ae60" stroke-width="2"/>
  <text x="700" y="95" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#1e8449">Solución: Decimación Selectiva</text>
  <text x="520" y="118" font-family="Arial, sans-serif" font-size="10" fill="#2c3e50">• Reducir muestras manteniendo contenido frecuencial</text>
  <text x="520" y="135" font-family="Arial, sans-serif" font-size="10" fill="#2c3e50">• Ratio específico por tipo de señal</text>
  <text x="520" y="152" font-family="Arial, sans-serif" font-size="10" fill="#2c3e50">• Nyquist respetado: f_display > 2 × f_max_señal</text>
  
  <!-- Diagrama ECG -->
  <rect x="50" y="190" width="280" height="180" rx="8" fill="#f8f9fa" stroke="#3498db" stroke-width="2"/>
  <rect x="50" y="190" width="280" height="30" rx="8" fill="#3498db"/>
  <text x="190" y="210" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">ECG - Decimación 3:1</text>
  
  <!-- Señal entrada ECG -->
  <text x="70" y="240" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#2c3e50">Entrada: 300 Hz</text>
  <rect x="70" y="248" width="100" height="30" rx="3" fill="url(#gradInput)"/>
  <g fill="none" stroke="white" stroke-width="1">
    <circle cx="80" cy="263" r="2"/>
    <circle cx="85" cy="263" r="2"/>
    <circle cx="90" cy="263" r="2"/>
    <circle cx="95" cy="258" r="2"/>
    <circle cx="100" cy="250" r="2"/>
    <circle cx="105" cy="270" r="2"/>
    <circle cx="110" cy="263" r="2"/>
    <circle cx="115" cy="263" r="2"/>
    <circle cx="120" cy="263" r="2"/>
    <circle cx="125" cy="263" r="2"/>
    <circle cx="130" cy="263" r="2"/>
    <circle cx="135" cy="263" r="2"/>
    <circle cx="140" cy="263" r="2"/>
    <circle cx="145" cy="263" r="2"/>
    <circle cx="150" cy="263" r="2"/>
    <circle cx="155" cy="258" r="2"/>
    <circle cx="160" cy="250" r="2"/>
    <circle cx="165" cy="270" r="2"/>
  </g>
  
  <!-- Flecha -->
  <line x1="175" y1="263" x2="195" y2="263" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowDec)"/>
  
  <!-- Decimador -->
  <rect x="200" y="248" width="40" height="30" rx="3" fill="url(#gradDecim)"/>
  <text x="220" y="267" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="white">↓3</text>
  
  <!-- Flecha -->
  <line x1="245" y1="263" x2="265" y2="263" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowDec)"/>
  
  <!-- Señal salida ECG -->
  <text x="270" y="240" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#2c3e50">Salida: 100 Hz</text>
  <rect x="200" y="283" width="100" height="25" rx="3" fill="url(#gradOutput)"/>
  <g fill="white">
    <circle cx="210" cy="295" r="2"/>
    <circle cx="225" cy="290" r="2"/>
    <circle cx="240" cy="305" r="2"/>
    <circle cx="255" cy="295" r="2"/>
    <circle cx="270" cy="295" r="2"/>
    <circle cx="285" cy="295" r="2"/>
  </g>
  
  <!-- Cálculos ECG -->
  <text x="70" y="330" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d">f_ECG_max ≈ 40 Hz (complejo QRS)</text>
  <text x="70" y="345" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d">f_Nyquist = 100/2 = 50 Hz > 40 Hz ✓</text>
  <text x="70" y="360" font-family="Arial, sans-serif" font-size="9" fill="#27ae60" font-weight="bold">Ratio: 300 ÷ 100 = 3:1</text>
  
  <!-- Diagrama EMG -->
  <rect x="340" y="190" width="280" height="180" rx="8" fill="#f8f9fa" stroke="#e67e22" stroke-width="2"/>
  <rect x="340" y="190" width="280" height="30" rx="8" fill="#e67e22"/>
  <text x="480" y="210" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">EMG - Decimación 10:1</text>
  
  <!-- Señal entrada EMG -->
  <text x="360" y="240" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#2c3e50">Entrada: 1000 Hz</text>
  <rect x="360" y="248" width="100" height="30" rx="3" fill="url(#gradInput)"/>
  <g fill="none" stroke="white" stroke-width="1">
    <!-- Muchos puntos para simular alta frecuencia -->
    <circle cx="365" cy="260" r="1"/>
    <circle cx="368" cy="265" r="1"/>
    <circle cx="371" cy="258" r="1"/>
    <circle cx="374" cy="270" r="1"/>
    <circle cx="377" cy="255" r="1"/>
    <circle cx="380" cy="268" r="1"/>
    <circle cx="383" cy="260" r="1"/>
    <circle cx="386" cy="263" r="1"/>
    <circle cx="389" cy="257" r="1"/>
    <circle cx="392" cy="270" r="1"/>
    <circle cx="395" cy="252" r="1"/>
    <circle cx="398" cy="273" r="1"/>
    <circle cx="401" cy="260" r="1"/>
    <circle cx="404" cy="265" r="1"/>
    <circle cx="407" cy="255" r="1"/>
    <circle cx="410" cy="268" r="1"/>
    <circle cx="413" cy="260" r="1"/>
    <circle cx="416" cy="263" r="1"/>
    <circle cx="419" cy="270" r="1"/>
    <circle cx="422" cy="253" r="1"/>
    <circle cx="425" cy="268" r="1"/>
    <circle cx="428" cy="258" r="1"/>
    <circle cx="431" cy="265" r="1"/>
    <circle cx="434" cy="270" r="1"/>
    <circle cx="437" cy="255" r="1"/>
    <circle cx="440" cy="263" r="1"/>
    <circle cx="443" cy="258" r="1"/>
    <circle cx="446" cy="273" r="1"/>
    <circle cx="449" cy="250" r="1"/>
    <circle cx="452" cy="270" r="1"/>
    <circle cx="455" cy="260" r="1"/>
  </g>
  
  <!-- Flecha -->
  <line x1="465" y1="263" x2="485" y2="263" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowDec)"/>
  
  <!-- Decimador -->
  <rect x="490" y="248" width="40" height="30" rx="3" fill="url(#gradDecim)"/>
  <text x="510" y="267" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="white">↓10</text>
  
  <!-- Flecha -->
  <line x1="535" y1="263" x2="555" y2="263" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowDec)"/>
  
  <!-- Señal salida EMG -->
  <text x="560" y="240" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#2c3e50">Salida: 100 Hz</text>
  <rect x="490" y="283" width="100" height="25" rx="3" fill="url(#gradOutput)"/>
  <g fill="white">
    <circle cx="500" cy="295" r="2"/>
    <circle cx="520" cy="290" r="2"/>
    <circle cx="540" cy="300" r="2"/>
    <circle cx="560" cy="288" r="2"/>
    <circle cx="580" cy="298" r="2"/>
  </g>
  
  <!-- Cálculos EMG -->
  <text x="360" y="330" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d">f_EMG_max ≈ 450 Hz (reclutamiento)</text>
  <text x="360" y="345" font-family="Arial, sans-serif" font-size="9" fill="#f39c12">f_Nyquist = 100/2 = 50 Hz &lt; 450 Hz</text>
  <text x="360" y="360" font-family="Arial, sans-serif" font-size="9" fill="#27ae60" font-weight="bold">Ratio: 1000 ÷ 100 = 10:1 (envolvente)</text>
  
  <!-- Diagrama PPG -->
  <rect x="630" y="190" width="280" height="180" rx="8" fill="#f8f9fa" stroke="#27ae60" stroke-width="2"/>
  <rect x="630" y="190" width="280" height="30" rx="8" fill="#27ae60"/>
  <text x="770" y="210" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">PPG - Sin Decimación (1:1)</text>
  
  <!-- Señal entrada PPG -->
  <text x="650" y="240" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#2c3e50">Entrada: 20 Hz</text>
  <rect x="650" y="248" width="100" height="30" rx="3" fill="url(#gradInput)"/>
  <g fill="none" stroke="white" stroke-width="1">
    <circle cx="660" cy="268" r="2"/>
    <circle cx="680" cy="255" r="2"/>
    <circle cx="700" cy="250" r="2"/>
    <circle cx="720" cy="260" r="2"/>
    <circle cx="740" cy="268" r="2"/>
  </g>
  
  <!-- Flecha directa -->
  <line x1="755" y1="263" x2="775" y2="263" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowDec)"/>
  
  <!-- Paso directo -->
  <rect x="780" y="248" width="40" height="30" rx="3" fill="#95a5a6"/>
  <text x="800" y="267" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="white">1:1</text>
  
  <!-- Flecha -->
  <line x1="825" y1="263" x2="845" y2="263" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowDec)"/>
  
  <!-- Señal salida PPG -->
  <text x="850" y="240" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#2c3e50">Salida: 20 Hz</text>
  <rect x="780" y="283" width="100" height="25" rx="3" fill="url(#gradOutput)"/>
  <g fill="white">
    <circle cx="790" cy="300" r="2"/>
    <circle cx="810" cy="287" r="2"/>
    <circle cx="830" cy="282" r="2"/>
    <circle cx="850" cy="292" r="2"/>
    <circle cx="870" cy="300" r="2"/>
  </g>
  
  <!-- Cálculos PPG -->
  <text x="650" y="330" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d">f_PPG_max ≈ 5 Hz (pulso arterial)</text>
  <text x="650" y="345" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d">f_Nyquist = 20/2 = 10 Hz > 5 Hz ✓</text>
  <text x="650" y="360" font-family="Arial, sans-serif" font-size="9" fill="#27ae60" font-weight="bold">Sin decimación necesaria</text>
  
  <!-- Tabla resumen -->
  <rect x="50" y="400" width="870" height="180" rx="8" fill="#f8f9fa" stroke="#bdc3c7" stroke-width="1"/>
  <text x="485" y="425" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#2c3e50">Resumen de Parámetros de Decimación</text>
  
  <!-- Headers tabla -->
  <line x1="60" y1="440" x2="910" y2="440" stroke="#bdc3c7" stroke-width="1"/>
  <text x="120" y="458" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#2c3e50">Señal</text>
  <text x="230" y="458" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#2c3e50">f_modelo</text>
  <text x="340" y="458" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#2c3e50">f_max señal</text>
  <text x="450" y="458" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#2c3e50">Ratio</text>
  <text x="560" y="458" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#2c3e50">f_salida</text>
  <text x="680" y="458" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#2c3e50">f_Nyquist</text>
  <text x="820" y="458" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#2c3e50">Verificación</text>
  <line x1="60" y1="468" x2="910" y2="468" stroke="#bdc3c7" stroke-width="1"/>
  
  <!-- Separadores verticales -->
  <line x1="175" y1="440" x2="175" y2="570" stroke="#bdc3c7" stroke-width="1"/>
  <line x1="285" y1="440" x2="285" y2="570" stroke="#bdc3c7" stroke-width="1"/>
  <line x1="395" y1="440" x2="395" y2="570" stroke="#bdc3c7" stroke-width="1"/>
  <line x1="505" y1="440" x2="505" y2="570" stroke="#bdc3c7" stroke-width="1"/>
  <line x1="615" y1="440" x2="615" y2="570" stroke="#bdc3c7" stroke-width="1"/>
  <line x1="745" y1="440" x2="745" y2="570" stroke="#bdc3c7" stroke-width="1"/>
  
  <!-- ECG row -->
  <rect x="65" y="475" width="60" height="20" rx="3" fill="#3498db"/>
  <text x="95" y="490" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="white">ECG</text>
  <text x="230" y="490" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#2c3e50">300 Hz</text>
  <text x="340" y="490" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#2c3e50">40 Hz</text>
  <text x="450" y="490" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#8e44ad" font-weight="bold">3:1</text>
  <text x="560" y="490" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#2c3e50">100 Hz</text>
  <text x="680" y="490" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#2c3e50">50 Hz</text>
  <text x="820" y="490" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#27ae60">50 > 40 ✓</text>
  
  <!-- EMG row -->
  <rect x="65" y="500" width="60" height="20" rx="3" fill="#e67e22"/>
  <text x="95" y="515" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="white">EMG</text>
  <text x="230" y="515" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#2c3e50">1000 Hz</text>
  <text x="340" y="515" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#2c3e50">450 Hz*</text>
  <text x="450" y="515" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#8e44ad" font-weight="bold">10:1</text>
  <text x="560" y="515" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#2c3e50">100 Hz</text>
  <text x="680" y="515" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#2c3e50">50 Hz</text>
  <text x="820" y="515" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#f39c12">Envolvente</text>
  
  <!-- PPG row -->
  <rect x="65" y="525" width="60" height="20" rx="3" fill="#27ae60"/>
  <text x="95" y="540" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="white">PPG</text>
  <text x="230" y="540" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#2c3e50">20 Hz</text>
  <text x="340" y="540" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#2c3e50">5 Hz</text>
  <text x="450" y="540" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#8e44ad" font-weight="bold">1:1</text>
  <text x="560" y="540" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#2c3e50">20 Hz</text>
  <text x="680" y="540" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#2c3e50">10 Hz</text>
  <text x="820" y="540" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#27ae60">10 > 5 ✓</text>
  
  <!-- Nota EMG -->
  <text x="70" y="565" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d">* EMG: La visualización muestra la envolvente del patrón de interferencia, no las MUAPs individuales (f_max_envolvente ≈ 10 Hz)</text>
</svg>
