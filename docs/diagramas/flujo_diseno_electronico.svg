<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 900" width="1400" height="900">
  <defs>
    <!-- Marcador de flecha -->
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#555"/>
    </marker>
    <marker id="arrowOrange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#FF9800"/>
    </marker>
    
    <!-- Sombra suave -->
    <filter id="shadow" x="-10%" y="-10%" width="120%" height="120%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.15"/>
    </filter>
  </defs>
  
  <!-- Fondo -->
  <rect width="1400" height="900" fill="#fafafa"/>
  
  <!-- T√≠tulo principal -->
  <text x="700" y="45" font-family="Segoe UI, Arial" font-size="26" font-weight="bold" fill="#333" text-anchor="middle">
    Flujo de Dise√±o Electr√≥nico - BioSignalSimulator Pro
  </text>
  <text x="700" y="70" font-family="Segoe UI, Arial" font-size="13" fill="#666" text-anchor="middle">
    Metodolog√≠a basada en an√°lisis espectral FFT para selecci√≥n de componentes
  </text>
  
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- FASE 1: REQUISITOS -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <g transform="translate(50, 100)">
    <rect x="0" y="0" width="240" height="180" rx="8" fill="#fff" stroke="#555" stroke-width="1.2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="240" height="32" rx="8" fill="#FF9800" opacity="0.15"/>
    <text x="120" y="22" font-family="Segoe UI, Arial" font-size="13" font-weight="bold" fill="#E65100" text-anchor="middle">
      1. REQUISITOS
    </text>
    <line x1="0" y1="32" x2="240" y2="32" stroke="#ddd" stroke-width="1"/>
    
    <text x="15" y="52" font-family="Segoe UI, Arial" font-size="10" fill="#333">‚Ä¢ Portabilidad: ‚â• 3 h autonom√≠a</text>
    <text x="15" y="68" font-family="Segoe UI, Arial" font-size="10" fill="#333">‚Ä¢ Se√±ales: ECG, EMG, PPG</text>
    <text x="15" y="84" font-family="Segoe UI, Arial" font-size="10" fill="#333">‚Ä¢ Salida: 0-3.3V anal√≥gica</text>
    <text x="15" y="100" font-family="Segoe UI, Arial" font-size="10" fill="#333">‚Ä¢ DAC: 2 kHz stepping</text>
    <text x="15" y="116" font-family="Segoe UI, Arial" font-size="10" fill="#333">‚Ä¢ Seguridad: IEC 61010-1</text>
    <text x="15" y="132" font-family="Segoe UI, Arial" font-size="10" fill="#333">‚Ä¢ Costo: &lt; $150 USD</text>
    <text x="15" y="148" font-family="Segoe UI, Arial" font-size="10" fill="#333">‚Ä¢ Display: Nextion 7"</text>
    <text x="15" y="164" font-family="Segoe UI, Arial" font-size="10" fill="#333">‚Ä¢ Carga: USB-C</text>
  </g>
  
  <!-- Flecha 1‚Üí2 -->
  <path d="M300,190 L340,190" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- FASE 2: AN√ÅLISIS ESPECTRAL (FFT) - Bloque central grande -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <g transform="translate(350, 100)">
    <rect x="0" y="0" width="380" height="300" rx="8" fill="#fff" stroke="#555" stroke-width="1.2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="380" height="32" rx="8" fill="#2196F3" opacity="0.15"/>
    <text x="190" y="22" font-family="Segoe UI, Arial" font-size="13" font-weight="bold" fill="#1565C0" text-anchor="middle">
      2. AN√ÅLISIS ESPECTRAL FFT
    </text>
    <line x1="0" y1="32" x2="380" y2="32" stroke="#ddd" stroke-width="1"/>
    
    <!-- Icono c√≥digo Python -->
    <rect x="15" y="45" width="165" height="95" rx="6" fill="#f5f5f5" stroke="#ddd" stroke-width="1"/>
    <text x="25" y="62" font-family="Consolas, monospace" font-size="9" fill="#1565C0">model_fft_analysis.py</text>
    <text x="25" y="77" font-family="Consolas, monospace" font-size="8" fill="#555">fft = np.fft.fft(signal)</text>
    <text x="25" y="89" font-family="Consolas, monospace" font-size="8" fill="#555">f99 = calc_energy(fft)</text>
    <text x="25" y="101" font-family="Consolas, monospace" font-size="8" fill="#555">fc = 2 √ó BW_20dB</text>
    <text x="25" y="113" font-family="Consolas, monospace" font-size="8" fill="#555">R = 1/(2œÄ√óFc√óC)</text>
    <text x="25" y="130" font-family="Consolas, monospace" font-size="8" fill="#FF9800">‚Üí Genera valores R</text>
    
    <!-- Resultados FFT por se√±al -->
    <rect x="195" y="45" width="170" height="95" rx="6" fill="#E3F2FD" stroke="#90CAF9" stroke-width="1"/>
    <text x="280" y="62" font-family="Segoe UI, Arial" font-size="10" font-weight="bold" fill="#1565C0" text-anchor="middle">RESULTADOS FFT</text>
    
    <text x="205" y="82" font-family="Segoe UI, Arial" font-size="9" fill="#E65100">ECG:</text>
    <text x="235" y="82" font-family="Consolas, monospace" font-size="9" fill="#333">F99%=21.6Hz</text>
    
    <text x="205" y="99" font-family="Segoe UI, Arial" font-size="9" fill="#E65100">EMG:</text>
    <text x="235" y="99" font-family="Consolas, monospace" font-size="9" fill="#333">F99%=146.3Hz</text>
    
    <text x="205" y="116" font-family="Segoe UI, Arial" font-size="9" fill="#E65100">PPG:</text>
    <text x="235" y="116" font-family="Consolas, monospace" font-size="9" fill="#333">F99%=4.9Hz</text>
    
    <text x="280" y="135" font-family="Segoe UI, Arial" font-size="8" fill="#666" text-anchor="middle">99% energ√≠a preservada</text>
    
    <!-- Tabla de filtros dise√±ados -->
    <rect x="15" y="150" width="350" height="140" rx="6" fill="#fff" stroke="#ddd" stroke-width="1"/>
    <text x="190" y="170" font-family="Segoe UI, Arial" font-size="11" font-weight="bold" fill="#4CAF50" text-anchor="middle">
      Dise√±o de Filtros RC (C = 1¬µF com√∫n)
    </text>
    
    <!-- Headers tabla -->
    <text x="45" y="190" font-family="Segoe UI, Arial" font-size="9" font-weight="bold" fill="#333">Se√±al</text>
    <text x="100" y="190" font-family="Segoe UI, Arial" font-size="9" font-weight="bold" fill="#333">BW-20dB</text>
    <text x="165" y="190" font-family="Segoe UI, Arial" font-size="9" font-weight="bold" fill="#333">Fc dise√±o</text>
    <text x="235" y="190" font-family="Segoe UI, Arial" font-size="9" font-weight="bold" fill="#333">R calc.</text>
    <text x="300" y="190" font-family="Segoe UI, Arial" font-size="9" font-weight="bold" fill="#333">R comercial</text>
    
    <line x1="25" y1="198" x2="355" y2="198" stroke="#ddd" stroke-width="1"/>
    
    <!-- ECG -->
    <rect x="28" y="206" width="10" height="10" fill="#e53935" rx="2"/>
    <text x="45" y="215" font-family="Segoe UI, Arial" font-size="9" fill="#333">ECG</text>
    <text x="100" y="215" font-family="Consolas, monospace" font-size="9" fill="#555">24.0 Hz</text>
    <text x="165" y="215" font-family="Consolas, monospace" font-size="9" fill="#555">23.4 Hz</text>
    <text x="235" y="215" font-family="Consolas, monospace" font-size="9" fill="#555">6803 Œ©</text>
    <text x="300" y="215" font-family="Consolas, monospace" font-size="9" font-weight="bold" fill="#c62828">6.8 kŒ©</text>
    
    <!-- EMG -->
    <rect x="28" y="226" width="10" height="10" fill="#43a047" rx="2"/>
    <text x="45" y="235" font-family="Segoe UI, Arial" font-size="9" fill="#333">EMG</text>
    <text x="100" y="235" font-family="Consolas, monospace" font-size="9" fill="#555">158.0 Hz</text>
    <text x="165" y="235" font-family="Consolas, monospace" font-size="9" fill="#555">159 Hz</text>
    <text x="235" y="235" font-family="Consolas, monospace" font-size="9" fill="#555">1000 Œ©</text>
    <text x="300" y="235" font-family="Consolas, monospace" font-size="9" font-weight="bold" fill="#2e7d32">1.0 kŒ©</text>
    
    <!-- PPG -->
    <rect x="28" y="246" width="10" height="10" fill="#1e88e5" rx="2"/>
    <text x="45" y="255" font-family="Segoe UI, Arial" font-size="9" fill="#333">PPG</text>
    <text x="100" y="255" font-family="Consolas, monospace" font-size="9" fill="#555">4.9 Hz</text>
    <text x="165" y="255" font-family="Consolas, monospace" font-size="9" fill="#555">6.37 Hz</text>
    <text x="235" y="255" font-family="Consolas, monospace" font-size="9" fill="#555">25000 Œ©</text>
    <text x="300" y="255" font-family="Consolas, monospace" font-size="9" font-weight="bold" fill="#1565c0">25 kŒ©</text>
    
    <text x="190" y="280" font-family="Segoe UI, Arial" font-size="8" fill="#666" text-anchor="middle">
      F√≥rmula: R = 1 / (2œÄ √ó Fc √ó C)  |  Serie E12 comercial
    </text>
  </g>
  
  <!-- Flecha 2‚Üí3 -->
  <path d="M740,250 L780,250" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- FASE 3: DISE√ëO DE SUBSISTEMAS -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <g transform="translate(790, 100)">
    <rect x="0" y="0" width="280" height="300" rx="8" fill="#fff" stroke="#555" stroke-width="1.2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="280" height="32" rx="8" fill="#9C27B0" opacity="0.15"/>
    <text x="140" y="22" font-family="Segoe UI, Arial" font-size="13" font-weight="bold" fill="#7B1FA2" text-anchor="middle">
      3. DISE√ëO SUBSISTEMAS
    </text>
    <line x1="0" y1="32" x2="280" y2="32" stroke="#ddd" stroke-width="1"/>
    
    <!-- Subsistema Alimentaci√≥n -->
    <rect x="12" y="45" width="256" height="75" rx="6" fill="#FFF3E0" stroke="#FF9800" stroke-width="1" stroke-dasharray="4,2"/>
    <text x="22" y="62" font-family="Segoe UI, Arial" font-size="10" font-weight="bold" fill="#E65100">‚ö° ALIMENTACI√ìN</text>
    <text x="22" y="78" font-family="Segoe UI, Arial" font-size="9" fill="#333">‚Ä¢ 2√ó Li-ion 18650 (3.7V, 2600mAh)</text>
    <text x="22" y="92" font-family="Segoe UI, Arial" font-size="9" fill="#333">‚Ä¢ IP5306: Carga USB-C + BMS 1S</text>
    <text x="22" y="106" font-family="Segoe UI, Arial" font-size="9" fill="#333">‚Ä¢ XL6009: Boost 3.7V ‚Üí 5V @ 3A</text>
    
    <!-- Subsistema Salida Anal√≥gica -->
    <rect x="12" y="130" width="256" height="75" rx="6" fill="#E8F5E9" stroke="#4CAF50" stroke-width="1" stroke-dasharray="4,2"/>
    <text x="22" y="147" font-family="Segoe UI, Arial" font-size="10" font-weight="bold" fill="#2E7D32">üì§ SALIDA ANAL√ìGICA</text>
    <text x="22" y="163" font-family="Segoe UI, Arial" font-size="9" fill="#333">‚Ä¢ DAC GPIO25 (8-bit, 2kHz)</text>
    <text x="22" y="177" font-family="Segoe UI, Arial" font-size="9" fill="#333">‚Ä¢ LM358: Buffer seguidor unity-gain</text>
    <text x="22" y="191" font-family="Segoe UI, Arial" font-size="9" fill="#333">‚Ä¢ CD4051 DEMUX ‚Üí 3√ó filtros RC</text>
    
    <!-- Subsistema Interfaz -->
    <rect x="12" y="215" width="256" height="75" rx="6" fill="#E3F2FD" stroke="#2196F3" stroke-width="1" stroke-dasharray="4,2"/>
    <text x="22" y="232" font-family="Segoe UI, Arial" font-size="10" font-weight="bold" fill="#1565C0">üñ•Ô∏è INTERFAZ</text>
    <text x="22" y="248" font-family="Segoe UI, Arial" font-size="9" fill="#333">‚Ä¢ Nextion NX8048T070 (7", 800√ó480)</text>
    <text x="22" y="262" font-family="Segoe UI, Arial" font-size="9" fill="#333">‚Ä¢ ESP32-WROOM-32 (dual-core)</text>
    <text x="22" y="276" font-family="Segoe UI, Arial" font-size="9" fill="#333">‚Ä¢ LED RGB indicador de estado</text>
  </g>
  
  <!-- Flecha 3‚Üí4 -->
  <path d="M1080,250 L1120,250" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- FASE 4: IMPLEMENTACI√ìN -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <g transform="translate(1130, 100)">
    <rect x="0" y="0" width="220" height="180" rx="8" fill="#fff" stroke="#555" stroke-width="1.2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="220" height="32" rx="8" fill="#4CAF50" opacity="0.15"/>
    <text x="110" y="22" font-family="Segoe UI, Arial" font-size="13" font-weight="bold" fill="#2E7D32" text-anchor="middle">
      4. IMPLEMENTACI√ìN
    </text>
    <line x1="0" y1="32" x2="220" y2="32" stroke="#ddd" stroke-width="1"/>
    
    <text x="15" y="52" font-family="Segoe UI, Arial" font-size="10" fill="#333">‚Ä¢ Protoboard de pruebas</text>
    <text x="15" y="68" font-family="Segoe UI, Arial" font-size="10" fill="#333">‚Ä¢ PCB dise√±ado (futuro)</text>
    <text x="15" y="84" font-family="Segoe UI, Arial" font-size="10" fill="#333">‚Ä¢ Soldadura de m√≥dulos</text>
    <text x="15" y="100" font-family="Segoe UI, Arial" font-size="10" fill="#333">‚Ä¢ 3√ó Conectores BNC</text>
    <text x="15" y="116" font-family="Segoe UI, Arial" font-size="10" fill="#333">‚Ä¢ Carcasa PETG impresa 3D</text>
    <text x="15" y="132" font-family="Segoe UI, Arial" font-size="10" fill="#333">‚Ä¢ Etiquetado seguridad</text>
    <text x="15" y="148" font-family="Segoe UI, Arial" font-size="10" fill="#333">‚Ä¢ Ensamblaje final</text>
    <text x="15" y="164" font-family="Segoe UI, Arial" font-size="10" fill="#333">‚Ä¢ Costo total: $145.40</text>
  </g>
  
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- FASE 5: VALIDACI√ìN -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <g transform="translate(1130, 300)">
    <rect x="0" y="0" width="220" height="100" rx="8" fill="#fff" stroke="#555" stroke-width="1.2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="220" height="28" rx="8" fill="#2196F3" opacity="0.15"/>
    <text x="110" y="20" font-family="Segoe UI, Arial" font-size="13" font-weight="bold" fill="#1565C0" text-anchor="middle">
      5. VALIDACI√ìN
    </text>
    <line x1="0" y1="28" x2="220" y2="28" stroke="#ddd" stroke-width="1"/>
    
    <text x="15" y="48" font-family="Segoe UI, Arial" font-size="10" fill="#333">‚Ä¢ Medici√≥n con osciloscopio</text>
    <text x="15" y="64" font-family="Segoe UI, Arial" font-size="10" fill="#333">‚Ä¢ Autonom√≠a real vs c√°lculo</text>
    <text x="15" y="80" font-family="Segoe UI, Arial" font-size="10" fill="#333">‚Ä¢ Atenuaci√≥n stepping @2kHz</text>
    <text x="15" y="96" font-family="Segoe UI, Arial" font-size="10" fill="#333">‚Ä¢ Meta: ‚â•5 horas operaci√≥n</text>
  </g>
  
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <!-- L√çNEA INFERIOR: DIAGRAMA DE BLOQUES DEL SISTEMA -->
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <rect x="50" y="430" width="1300" height="450" rx="10" fill="#fff" stroke="#555" stroke-width="1.5" stroke-dasharray="8,4" filter="url(#shadow)"/>
  
  <text x="700" y="460" font-family="Segoe UI, Arial" font-size="16" font-weight="bold" fill="#333" text-anchor="middle">
    Diagrama de Bloques del Sistema Electr√≥nico
  </text>
  
  <!-- Bloque BATER√çA -->
  <g transform="translate(70, 500)">
    <rect x="0" y="0" width="140" height="120" rx="8" fill="#fff" stroke="#FF9800" stroke-width="1.5" stroke-dasharray="4,2"/>
    <text x="70" y="22" font-family="Segoe UI, Arial" font-size="11" font-weight="bold" fill="#E65100" text-anchor="middle">BATER√çA</text>
    <line x1="10" y1="32" x2="130" y2="32" stroke="#ddd" stroke-width="1"/>
    <text x="70" y="50" font-family="Segoe UI, Arial" font-size="9" fill="#333" text-anchor="middle">2√ó 18650</text>
    <text x="70" y="66" font-family="Segoe UI, Arial" font-size="9" fill="#333" text-anchor="middle">3.7V @ 5200mAh</text>
    <rect x="25" y="78" width="90" height="28" rx="5" fill="#FFF3E0" stroke="#FF9800" stroke-width="1"/>
    <text x="70" y="97" font-family="Segoe UI, Arial" font-size="9" font-weight="bold" fill="#E65100" text-anchor="middle">IP5306 BMS</text>
  </g>
  
  <!-- Flecha Bater√≠a ‚Üí Boost -->
  <path d="M220,560 L260,560" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <text x="240" y="550" font-family="Consolas, monospace" font-size="9" fill="#555" text-anchor="middle">3.7V</text>
  
  <!-- Bloque BOOST -->
  <g transform="translate(270, 510)">
    <rect x="0" y="0" width="120" height="100" rx="8" fill="#fff" stroke="#FF9800" stroke-width="1.5" stroke-dasharray="4,2"/>
    <text x="60" y="22" font-family="Segoe UI, Arial" font-size="11" font-weight="bold" fill="#E65100" text-anchor="middle">BOOST</text>
    <line x1="10" y1="32" x2="110" y2="32" stroke="#ddd" stroke-width="1"/>
    <text x="60" y="52" font-family="Segoe UI, Arial" font-size="9" fill="#333" text-anchor="middle">XL6009</text>
    <text x="60" y="68" font-family="Segoe UI, Arial" font-size="9" fill="#333" text-anchor="middle">3.7V ‚Üí 5V</text>
    <text x="60" y="84" font-family="Segoe UI, Arial" font-size="9" fill="#333" text-anchor="middle">@ 3A max</text>
  </g>
  
  <!-- Flecha Boost ‚Üí Cargas -->
  <path d="M400,560 L440,560" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <text x="420" y="550" font-family="Consolas, monospace" font-size="9" fill="#555" text-anchor="middle">5V</text>
  
  <!-- Bloque ESP32 -->
  <g transform="translate(450, 490)">
    <rect x="0" y="0" width="160" height="140" rx="8" fill="#fff" stroke="#2196F3" stroke-width="1.5" stroke-dasharray="4,2"/>
    <text x="80" y="22" font-family="Segoe UI, Arial" font-size="11" font-weight="bold" fill="#1565C0" text-anchor="middle">ESP32-WROOM-32</text>
    <line x1="10" y1="32" x2="150" y2="32" stroke="#ddd" stroke-width="1"/>
    <text x="80" y="50" font-family="Segoe UI, Arial" font-size="9" fill="#333" text-anchor="middle">Dual-core @ 240MHz</text>
    <text x="80" y="66" font-family="Segoe UI, Arial" font-size="9" fill="#333" text-anchor="middle">WiFi AP (WebSocket)</text>
    <rect x="20" y="78" width="120" height="22" rx="4" fill="#E3F2FD" stroke="#90CAF9" stroke-width="1"/>
    <text x="80" y="93" font-family="Consolas, monospace" font-size="9" fill="#1565C0" text-anchor="middle">DAC GPIO25</text>
    <rect x="20" y="106" width="120" height="22" rx="4" fill="#E3F2FD" stroke="#90CAF9" stroke-width="1"/>
    <text x="80" y="121" font-family="Consolas, monospace" font-size="9" fill="#1565C0" text-anchor="middle">GPIO32/33 (MUX)</text>
  </g>
  
  <!-- Flecha ESP32 ‚Üí Buffer -->
  <path d="M620,560 L660,560" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <text x="640" y="550" font-family="Consolas, monospace" font-size="9" fill="#555" text-anchor="middle">0-3.3V</text>
  
  <!-- Bloque BUFFER LM358 -->
  <g transform="translate(670, 520)">
    <rect x="0" y="0" width="110" height="80" rx="8" fill="#fff" stroke="#4CAF50" stroke-width="1.5" stroke-dasharray="4,2"/>
    <text x="55" y="20" font-family="Segoe UI, Arial" font-size="10" font-weight="bold" fill="#2E7D32" text-anchor="middle">BUFFER</text>
    <text x="55" y="38" font-family="Segoe UI, Arial" font-size="9" fill="#333" text-anchor="middle">LM358</text>
    <text x="55" y="54" font-family="Segoe UI, Arial" font-size="9" fill="#333" text-anchor="middle">Unity-gain</text>
    <text x="55" y="70" font-family="Segoe UI, Arial" font-size="9" fill="#333" text-anchor="middle">Zout: 10Œ©</text>
  </g>
  
  <!-- Flecha Buffer ‚Üí MUX -->
  <path d="M790,560 L830,560" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- Bloque CD4051 DEMUX -->
  <g transform="translate(840, 510)">
    <rect x="0" y="0" width="130" height="100" rx="8" fill="#fff" stroke="#4CAF50" stroke-width="1.5" stroke-dasharray="4,2"/>
    <text x="65" y="20" font-family="Segoe UI, Arial" font-size="10" font-weight="bold" fill="#2E7D32" text-anchor="middle">DEMUX</text>
    <text x="65" y="38" font-family="Segoe UI, Arial" font-size="9" fill="#333" text-anchor="middle">CD4051</text>
    <line x1="10" y1="46" x2="120" y2="46" stroke="#ddd" stroke-width="1"/>
    <text x="65" y="62" font-family="Segoe UI, Arial" font-size="9" fill="#333" text-anchor="middle">COM ‚Üí CH0/1/2</text>
    <text x="65" y="78" font-family="Segoe UI, Arial" font-size="9" fill="#333" text-anchor="middle">S0/S1 control</text>
  </g>
  
  <!-- Flechas MUX ‚Üí Filtros -->
  <path d="M980,530 L1020,500" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <path d="M980,560 L1020,560" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <path d="M980,590 L1020,620" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- Bloque Filtros RC + BNC -->
  <g transform="translate(1030, 470)">
    <!-- ECG -->
    <rect x="0" y="0" width="150" height="50" rx="6" fill="#fff" stroke="#e53935" stroke-width="1.5"/>
    <text x="15" y="18" font-family="Segoe UI, Arial" font-size="10" font-weight="bold" fill="#c62828">ECG</text>
    <text x="15" y="34" font-family="Consolas, monospace" font-size="9" fill="#333">6.8kŒ© + 1¬µF</text>
    <text x="100" y="18" font-family="Consolas, monospace" font-size="8" fill="#555">Fc=23.4Hz</text>
    <circle cx="135" cy="25" r="10" fill="#e53935"/>
    <text x="135" y="29" font-family="Segoe UI, Arial" font-size="7" fill="white" text-anchor="middle">BNC</text>
    
    <!-- EMG -->
    <rect x="0" y="60" width="150" height="50" rx="6" fill="#fff" stroke="#43a047" stroke-width="1.5"/>
    <text x="15" y="78" font-family="Segoe UI, Arial" font-size="10" font-weight="bold" fill="#2e7d32">EMG</text>
    <text x="15" y="94" font-family="Consolas, monospace" font-size="9" fill="#333">1.0kŒ© + 1¬µF</text>
    <text x="100" y="78" font-family="Consolas, monospace" font-size="8" fill="#555">Fc=159Hz</text>
    <circle cx="135" cy="85" r="10" fill="#43a047"/>
    <text x="135" y="89" font-family="Segoe UI, Arial" font-size="7" fill="white" text-anchor="middle">BNC</text>
    
    <!-- PPG -->
    <rect x="0" y="120" width="150" height="50" rx="6" fill="#fff" stroke="#1e88e5" stroke-width="1.5"/>
    <text x="15" y="138" font-family="Segoe UI, Arial" font-size="10" font-weight="bold" fill="#1565c0">PPG</text>
    <text x="15" y="154" font-family="Consolas, monospace" font-size="9" fill="#333">25kŒ© + 1¬µF</text>
    <text x="100" y="138" font-family="Consolas, monospace" font-size="8" fill="#555">Fc=6.37Hz</text>
    <circle cx="135" cy="145" r="10" fill="#1e88e5"/>
    <text x="135" y="149" font-family="Segoe UI, Arial" font-size="7" fill="white" text-anchor="middle">BNC</text>
  </g>
  
  <!-- Salida a osciloscopio/equipo -->
  <path d="M1195,495 L1230,495 L1230,560 L1280,560" stroke="#555" stroke-width="2" fill="none"/>
  <path d="M1195,555 L1240,555 L1240,560 L1280,560" stroke="#555" stroke-width="2" fill="none"/>
  <path d="M1195,615 L1230,615 L1230,560 L1280,560" stroke="#555" stroke-width="2" fill="none"/>
  
  <rect x="1280" y="530" width="60" height="60" rx="6" fill="#333" stroke="#555" stroke-width="1"/>
  <text x="1310" y="555" font-family="Segoe UI, Arial" font-size="9" fill="white" text-anchor="middle">OSC</text>
  <text x="1310" y="570" font-family="Segoe UI, Arial" font-size="8" fill="#aaa" text-anchor="middle">o equipo</text>
  
  <!-- Bloque NEXTION (paralelo) -->
  <g transform="translate(450, 660)">
    <rect x="0" y="0" width="160" height="80" rx="8" fill="#fff" stroke="#2196F3" stroke-width="1.5" stroke-dasharray="4,2"/>
    <text x="80" y="20" font-family="Segoe UI, Arial" font-size="10" font-weight="bold" fill="#1565C0" text-anchor="middle">NEXTION 7"</text>
    <text x="80" y="38" font-family="Segoe UI, Arial" font-size="9" fill="#333" text-anchor="middle">NX8048T070</text>
    <text x="80" y="54" font-family="Segoe UI, Arial" font-size="9" fill="#333" text-anchor="middle">800√ó480 px</text>
    <text x="80" y="70" font-family="Segoe UI, Arial" font-size="9" fill="#333" text-anchor="middle">UART2 115200</text>
  </g>
  
  <!-- Conexi√≥n ESP32 ‚Üî Nextion -->
  <path d="M530,630 L530,660" stroke="#2196F3" stroke-width="1.5" fill="none"/>
  <text x="545" y="648" font-family="Consolas, monospace" font-size="8" fill="#1565C0">UART2</text>
  
  <!-- Bloque LED RGB -->
  <g transform="translate(670, 660)">
    <rect x="0" y="0" width="110" height="80" rx="8" fill="#fff" stroke="#9C27B0" stroke-width="1.5" stroke-dasharray="4,2"/>
    <text x="55" y="20" font-family="Segoe UI, Arial" font-size="10" font-weight="bold" fill="#7B1FA2" text-anchor="middle">LED RGB</text>
    <text x="55" y="38" font-family="Segoe UI, Arial" font-size="9" fill="#333" text-anchor="middle">Indicador</text>
    <circle cx="30" cy="58" r="10" fill="#e53935"/>
    <circle cx="55" cy="58" r="10" fill="#43a047"/>
    <circle cx="80" cy="58" r="10" fill="#1e88e5"/>
  </g>
  
  <!-- Conexi√≥n ESP32 ‚Üí LED -->
  <path d="M610,630 L725,660" stroke="#9C27B0" stroke-width="1.5" fill="none" stroke-dasharray="4,2"/>
  
  <!-- Nota de atenuaci√≥n stepping -->
  <g transform="translate(1030, 780)">
    <rect x="0" y="0" width="280" height="70" rx="6" fill="#fff" stroke="#555" stroke-width="1"/>
    <text x="140" y="18" font-family="Segoe UI, Arial" font-size="10" font-weight="bold" fill="#333" text-anchor="middle">Atenuaci√≥n del Stepping DAC @ 2kHz</text>
    <text x="20" y="36" font-family="Consolas, monospace" font-size="9" fill="#555">ECG: -44 dB (158√ó)</text>
    <text x="150" y="36" font-family="Consolas, monospace" font-size="9" fill="#555">EMG: -28 dB (25√ó)</text>
    <text x="20" y="52" font-family="Consolas, monospace" font-size="9" fill="#555">PPG: -58 dB (800√ó)</text>
    <text x="150" y="52" font-family="Consolas, monospace" font-size="9" fill="#4CAF50">Stepping eliminado ‚úì</text>
  </g>
  
  <!-- Leyenda de c√≥digo de colores -->
  <g transform="translate(70, 780)">
    <rect x="0" y="0" width="220" height="70" rx="6" fill="#fff" stroke="#555" stroke-width="1"/>
    <text x="110" y="18" font-family="Segoe UI, Arial" font-size="10" font-weight="bold" fill="#333" text-anchor="middle">Frecuencias de Corte</text>
    <circle cx="20" cy="35" r="6" fill="#e53935"/>
    <text x="35" y="39" font-family="Segoe UI, Arial" font-size="9" fill="#333">ECG (Fc=23.4Hz)</text>
    <circle cx="130" cy="35" r="6" fill="#43a047"/>
    <text x="145" y="39" font-family="Segoe UI, Arial" font-size="9" fill="#333">EMG (Fc=159Hz)</text>
    <circle cx="20" cy="55" r="6" fill="#1e88e5"/>
    <text x="35" y="59" font-family="Segoe UI, Arial" font-size="9" fill="#333">PPG (Fc=6.37Hz)</text>
  </g>
</svg>
