<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 950 700">
  <defs>
    <marker id="arrowBlack" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2c3e50"/>
    </marker>
    <linearGradient id="gradNextion" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#2c3e50;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#34495e;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="gradWaveform" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#1a1a2e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#16213e;stop-opacity:1" />
    </linearGradient>
  </defs>
  
  <!-- Título principal -->
  <text x="475" y="30" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    Arquitectura de Visualización Nextion HMI
  </text>
  
  <!-- Marco display Nextion -->
  <rect x="50" y="50" width="520" height="330" rx="10" fill="#1a1a1a" stroke="#2c3e50" stroke-width="3"/>
  <text x="310" y="72" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#7f8c8d">Display Nextion NX8048P070 - 800×480 px</text>
  
  <!-- Área de waveform -->
  <rect x="70" y="85" width="480" height="200" rx="3" fill="url(#gradWaveform)" stroke="#3498db" stroke-width="2"/>
  
  <!-- Grid del waveform -->
  <g stroke="#2d4a3e" stroke-width="0.5" opacity="0.6">
    <!-- Líneas verticales - cada 20px -->
    <line x1="90" y1="85" x2="90" y2="285"/>
    <line x1="110" y1="85" x2="110" y2="285"/>
    <line x1="130" y1="85" x2="130" y2="285"/>
    <line x1="150" y1="85" x2="150" y2="285"/>
    <line x1="170" y1="85" x2="170" y2="285"/>
    <line x1="190" y1="85" x2="190" y2="285"/>
    <line x1="210" y1="85" x2="210" y2="285"/>
    <line x1="230" y1="85" x2="230" y2="285"/>
    <line x1="250" y1="85" x2="250" y2="285"/>
    <line x1="270" y1="85" x2="270" y2="285"/>
    <line x1="290" y1="85" x2="290" y2="285"/>
    <line x1="310" y1="85" x2="310" y2="285"/>
    <line x1="330" y1="85" x2="330" y2="285"/>
    <line x1="350" y1="85" x2="350" y2="285"/>
    <line x1="370" y1="85" x2="370" y2="285"/>
    <line x1="390" y1="85" x2="390" y2="285"/>
    <line x1="410" y1="85" x2="410" y2="285"/>
    <line x1="430" y1="85" x2="430" y2="285"/>
    <line x1="450" y1="85" x2="450" y2="285"/>
    <line x1="470" y1="85" x2="470" y2="285"/>
    <line x1="490" y1="85" x2="490" y2="285"/>
    <line x1="510" y1="85" x2="510" y2="285"/>
    <line x1="530" y1="85" x2="530" y2="285"/>
    <!-- Líneas horizontales -->
    <line x1="70" y1="110" x2="550" y2="110"/>
    <line x1="70" y1="135" x2="550" y2="135"/>
    <line x1="70" y1="160" x2="550" y2="160"/>
    <line x1="70" y1="185" x2="550" y2="185"/>
    <line x1="70" y1="210" x2="550" y2="210"/>
    <line x1="70" y1="235" x2="550" y2="235"/>
    <line x1="70" y1="260" x2="550" y2="260"/>
  </g>
  
  <!-- Señal ECG simulada -->
  <polyline points="70,185 90,185 100,183 110,185 120,185 125,180 130,195 135,140 140,220 145,170 150,185 170,185 190,185 200,183 210,185 220,185 225,180 230,195 235,140 240,220 245,170 250,185 270,185 290,185 300,183 310,185 320,185 325,180 330,195 335,140 340,220 345,170 350,185 370,185 390,185 400,183 410,185 420,185 425,180 430,195 435,140 440,220 445,170 450,185 470,185 490,185 500,183 510,185 520,185 530,180 540,195 545,150" 
        fill="none" stroke="#2ecc71" stroke-width="2"/>
  
  <!-- Etiquetas waveform -->
  <text x="80" y="100" font-family="Arial, sans-serif" font-size="10" fill="#3498db">ECG Lead II</text>
  <text x="520" y="100" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d" text-anchor="end">25mm/s</text>
  
  <!-- Panel de métricas -->
  <rect x="70" y="295" width="480" height="70" rx="3" fill="#0d1117" stroke="#3498db" stroke-width="1"/>
  
  <!-- Métricas individuales -->
  <g font-family="Arial, sans-serif">
    <!-- HR -->
    <text x="90" y="320" font-size="10" fill="#7f8c8d">HR</text>
    <text x="90" y="345" font-size="24" font-weight="bold" fill="#2ecc71">72</text>
    <text x="130" y="345" font-size="10" fill="#7f8c8d">bpm</text>
    <!-- SpO2 -->
    <text x="200" y="320" font-size="10" fill="#7f8c8d">SpO2</text>
    <text x="200" y="345" font-size="24" font-weight="bold" fill="#3498db">98</text>
    <text x="240" y="345" font-size="10" fill="#7f8c8d">%</text>
    <!-- Amplitud -->
    <text x="310" y="320" font-size="10" fill="#7f8c8d">Amp</text>
    <text x="310" y="345" font-size="24" font-weight="bold" fill="#e74c3c">1.2</text>
    <text x="360" y="345" font-size="10" fill="#7f8c8d">mV</text>
    <!-- Signal Type -->
    <text x="430" y="320" font-size="10" fill="#7f8c8d">Mode</text>
    <text x="430" y="345" font-size="18" font-weight="bold" fill="#f39c12">ECG</text>
  </g>
  
  <!-- Especificaciones técnicas panel derecho -->
  <rect x="590" y="50" width="340" height="330" rx="8" fill="#f8f9fa" stroke="#bdc3c7" stroke-width="1"/>
  <text x="760" y="75" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#2c3e50">Especificaciones Waveform</text>
  
  <!-- Dimensiones -->
  <rect x="605" y="90" width="310" height="80" rx="5" fill="#fff" stroke="#e0e0e0" stroke-width="1"/>
  <text x="620" y="110" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2c3e50">Dimensiones del Componente</text>
  <text x="620" y="130" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">Ancho:</text>
  <text x="720" y="130" font-family="Courier New" font-size="10" fill="#8e44ad">480 px</text>
  <text x="620" y="145" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">Alto:</text>
  <text x="720" y="145" font-family="Courier New" font-size="10" fill="#8e44ad">200 px</text>
  <text x="620" y="160" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">Buffer interno:</text>
  <text x="720" y="160" font-family="Courier New" font-size="10" fill="#8e44ad">480 muestras</text>
  
  <!-- Temporización -->
  <rect x="605" y="180" width="310" height="80" rx="5" fill="#fff" stroke="#e0e0e0" stroke-width="1"/>
  <text x="620" y="200" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2c3e50">Parámetros Temporales</text>
  <text x="620" y="220" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">Frecuencia actualización:</text>
  <text x="790" y="220" font-family="Courier New" font-size="10" fill="#8e44ad">100 Hz</text>
  <text x="620" y="235" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">Ventana visible:</text>
  <text x="790" y="235" font-family="Courier New" font-size="10" fill="#8e44ad">4.8 s</text>
  <text x="620" y="250" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">Resolución temporal:</text>
  <text x="790" y="250" font-family="Courier New" font-size="10" fill="#8e44ad">10 ms/px</text>
  
  <!-- Comunicación -->
  <rect x="605" y="270" width="310" height="100" rx="5" fill="#fff" stroke="#e0e0e0" stroke-width="1"/>
  <text x="620" y="290" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2c3e50">Protocolo de Comunicación</text>
  <text x="620" y="310" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">Interfaz:</text>
  <text x="720" y="310" font-family="Courier New" font-size="10" fill="#8e44ad">UART2 Serial</text>
  <text x="620" y="325" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">Baud rate:</text>
  <text x="720" y="325" font-family="Courier New" font-size="10" fill="#8e44ad">115200 bps</text>
  <text x="620" y="340" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">Comando waveform:</text>
  <text x="720" y="340" font-family="Courier New" font-size="9" fill="#8e44ad">add ch,id,val</text>
  <text x="620" y="355" font-family="Arial, sans-serif" font-size="10" fill="#7f8c8d">Terminador:</text>
  <text x="720" y="355" font-family="Courier New" font-size="10" fill="#8e44ad">0xFF 0xFF 0xFF</text>
  
  <!-- Sección de Grid Calculation -->
  <rect x="50" y="400" width="880" height="140" rx="8" fill="#f8f9fa" stroke="#bdc3c7" stroke-width="1"/>
  <text x="490" y="425" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#2c3e50">Cálculo de Grid (Cuadrícula) por Tipo de Señal</text>
  
  <!-- Headers tabla grid -->
  <line x1="60" y1="440" x2="920" y2="440" stroke="#bdc3c7" stroke-width="1"/>
  <text x="130" y="458" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#2c3e50">Señal</text>
  <text x="270" y="458" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#2c3e50">Estándar Clínico</text>
  <text x="440" y="458" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#2c3e50">Grid Temporal</text>
  <text x="620" y="458" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#2c3e50">Grid Amplitud</text>
  <text x="800" y="458" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#2c3e50">Divisiones</text>
  <line x1="60" y1="468" x2="920" y2="468" stroke="#bdc3c7" stroke-width="1"/>
  
  <!-- Separadores verticales -->
  <line x1="200" y1="440" x2="200" y2="530" stroke="#bdc3c7" stroke-width="1"/>
  <line x1="350" y1="440" x2="350" y2="530" stroke="#bdc3c7" stroke-width="1"/>
  <line x1="530" y1="440" x2="530" y2="530" stroke="#bdc3c7" stroke-width="1"/>
  <line x1="710" y1="440" x2="710" y2="530" stroke="#bdc3c7" stroke-width="1"/>
  
  <!-- ECG -->
  <rect x="65" y="475" width="60" height="18" rx="3" fill="#2ecc71"/>
  <text x="95" y="488" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="white">ECG</text>
  <text x="270" y="490" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#2c3e50">25 mm/s, 10 mm/mV</text>
  <text x="440" y="490" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#8e44ad">20 px = 200 ms</text>
  <text x="620" y="490" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#8e44ad">50 px = 0.5 mV</text>
  <text x="800" y="490" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#2c3e50">24×4</text>
  
  <!-- EMG -->
  <rect x="65" y="500" width="60" height="18" rx="3" fill="#e67e22"/>
  <text x="95" y="513" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="white">EMG</text>
  <text x="270" y="515" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#2c3e50">10 mm/s, 2 mm/mV</text>
  <text x="440" y="515" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#8e44ad">48 px = 480 ms</text>
  <text x="620" y="515" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#8e44ad">40 px = 2 mV</text>
  <text x="800" y="515" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#2c3e50">10×5</text>
  
  <!-- PPG -->
  <rect x="65" y="525" width="60" height="18" rx="3" fill="#3498db"/>
  <text x="95" y="538" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="white">PPG</text>
  <text x="270" y="540" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#2c3e50">Velocidad variable</text>
  <text x="440" y="540" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#8e44ad">96 px = 960 ms</text>
  <text x="620" y="540" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#8e44ad">50 px = 50% AMP</text>
  <text x="800" y="540" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#2c3e50">5×4</text>
  
  <!-- Flujo de datos UART -->
  <rect x="50" y="560" width="880" height="130" rx="8" fill="#eef7ff" stroke="#3498db" stroke-width="2"/>
  <text x="490" y="585" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#2c3e50">Flujo de Datos ESP32 → Nextion</text>
  
  <!-- Bloques del flujo -->
  <rect x="70" y="605" width="120" height="60" rx="5" fill="#3498db" stroke="#2980b9" stroke-width="2"/>
  <text x="130" y="630" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="white">Muestra</text>
  <text x="130" y="648" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#ecf0f1">float mV</text>
  
  <line x1="190" y1="635" x2="230" y2="635" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowBlack)"/>
  
  <rect x="235" y="605" width="130" height="60" rx="5" fill="#9b59b6" stroke="#8e44ad" stroke-width="2"/>
  <text x="300" y="625" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="white">Decimación</text>
  <text x="300" y="643" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#ecf0f1">ECG:3:1 EMG:10:1</text>
  <text x="300" y="658" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#ecf0f1">PPG:1:1</text>
  
  <line x1="365" y1="635" x2="405" y2="635" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowBlack)"/>
  
  <rect x="410" y="605" width="130" height="60" rx="5" fill="#e67e22" stroke="#d35400" stroke-width="2"/>
  <text x="475" y="625" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="white">Escalado</text>
  <text x="475" y="643" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#ecf0f1">mV → [0,255]</text>
  <text x="475" y="658" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#ecf0f1">uint8_t</text>
  
  <line x1="540" y1="635" x2="580" y2="635" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowBlack)"/>
  
  <rect x="585" y="605" width="140" height="60" rx="5" fill="#1abc9c" stroke="#16a085" stroke-width="2"/>
  <text x="655" y="625" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="white">Comando UART</text>
  <text x="655" y="643" font-family="Courier New" font-size="9" text-anchor="middle" fill="#ecf0f1">add 1,0,val</text>
  <text x="655" y="658" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#ecf0f1">+ 0xFFFFFF</text>
  
  <line x1="725" y1="635" x2="765" y2="635" stroke="#2c3e50" stroke-width="2" marker-end="url(#arrowBlack)"/>
  
  <rect x="770" y="605" width="140" height="60" rx="5" fill="#2c3e50" stroke="#1a252f" stroke-width="2"/>
  <text x="840" y="625" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="white">Waveform</text>
  <text x="840" y="643" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#2ecc71">Renderizado</text>
  <text x="840" y="658" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#ecf0f1">@100 Hz</text>
</svg>
